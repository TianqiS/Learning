- Log replication

  当leader被选举出来之后，开始服务client发送过来的请求，步骤如下：

  1. leader把这条命令作为新的日志条目加入到它的日志中去

  2. 然后并行的向其他服务器发起 AppendEntries RPC ，要求其它服务器复制这个条目

  3. 当这个条目被安全的复制之后，leader会将这个条目应用到它的状态机(state machine)中并且会向客户端返回执行结果

     如果flower崩溃了或者运行缓慢或者是网络丢包了，leader会无限的重试 AppendEntries RPC（甚至在它向client响应之后）直到所有的flower最终存储了所有的日志条目。

  ![Raft 一致性算法论文译文](https://static001.infoq.cn/resource/image/f8/17/f8c0dbf1686e6aff7052a9c399141a17.jpg)

  日志由	有序编号的日志条目组成，每个日志条目包含它被创建时的任期号（每个方块中的数字），并且包含用于状态机执行的命令。如果一个条目能够被状态机安全执行，就被认为可以提交了。

  leader决定什么时候将日志条目应用到状态机是安全的；这种条目被称为可被提交（commited）。Raft 保证可被提交（commited）的日志条目是持久化的并且最终会被所有可用的状态机执行。一旦被leader创建的条目已经复制到了大多数的服务器上，这个条目就称为可被提交的，之前的日志记录同样会被提交，这其中也包括在之前被其他leader提交的日志

  leader跟踪记录它所知道的被提交条目的最大索引值，并且这个索引值会包含在之后的 AppendEntries RPC 中（包括心跳 heartbeat 中），为的是让其他服务器都知道这条条目已经提交。一旦一个flower知道了一个日志条目已经被提交，它会将该条目应用至本地的状态机（按照日志顺序）。
  
- 

